<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valentine</title>

  <style>
    :root{
      --pink:#ff2d7a;
      --pink2:#ff4f93;
      --white:#ffffff;
      --shadow: rgba(0,0,0,0.25);
    }

    html,body{
      height:100%;
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      overflow:hidden;
    }

    /* Background image */
    .bg{
      position:fixed;
      inset:0;
      background: url("./song_image.jpg") center/cover no-repeat;
    }
    .bg::after{
      content:"";
      position:absolute;
      inset:0;
      background: rgba(0,0,0,0.25);
    }

    /* Floating hearts background */
    #bgHearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:1;
      overflow:hidden;
    }
    .heart{
      position:absolute;
      bottom:-40px;
      color: rgba(255,255,255,0.9);
      text-shadow: 0 4px 16px rgba(0,0,0,0.35);
      animation: floatUp linear forwards;
      user-select:none;
      will-change: transform, opacity;
    }
    @keyframes floatUp{
      0%{ transform: translateY(0) scale(1); opacity:0; }
      10%{ opacity: 0.9; }
      100%{ transform: translateY(-120vh) scale(1.15); opacity:0; }
    }

    /* Center card */
    .wrap{
      position:relative;
      z-index:5;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .card{
      width:min(520px, 92vw);
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.25);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border-radius: 24px;
      box-shadow: 0 18px 60px var(--shadow);
      padding: 26px 22px;
      text-align:center;
      color: #fff;
    }

    h1{
      margin: 0 0 14px;
      font-size: 34px;
      font-weight: 800;
      letter-spacing: 0.2px;
      text-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }

    p{
      margin: 0 0 18px;
      font-size: 18px;
      line-height: 1.3;
      text-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }

    .btnRow{
      display:flex;
      gap: 12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    .btn{
      border:none;
      border-radius: 16px;
      padding: 14px 18px;
      font-size: 18px;
      font-weight: 800;
      cursor:pointer;
      transition: transform .08s ease, filter .2s ease, box-shadow .2s ease;
      box-shadow: 0 12px 30px rgba(0,0,0,0.22);
      user-select:none;
      min-width: 138px;
    }
    .btn:active{ transform: scale(0.98); }

    .btnYes{
      background: linear-gradient(180deg, var(--pink2), var(--pink));
      color:#fff;
    }
    .btnNo{
      background: rgba(255,255,255,0.22);
      color:#fff;
      border: 1px solid rgba(255,255,255,0.22);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* Solid heart button */
    .heartBtn{
      position: relative;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width: 170px;
      height: 120px;
      border: none;
      background: transparent;
      cursor: pointer;
      margin: 8px auto 0;
      user-select:none;
    }
    .heartShape{
      position:absolute;
      width: 150px;
      height: 130px;
      background: var(--pink);
      transform: rotate(-45deg);
      border-radius: 18px;
      box-shadow: 0 18px 44px rgba(0,0,0,0.25);
    }
    .heartShape::before,
    .heartShape::after{
      content:"";
      position:absolute;
      width: 150px;
      height: 130px;
      background: var(--pink);
      border-radius: 999px;
    }
    .heartShape::before{
      top: -70px;
      left: 0;
    }
    .heartShape::after{
      top: 0;
      left: 70px;
    }
    .heartText{
      position:relative;
      z-index:2;
      font-size: 28px;
      font-weight: 900;
      color: #fff;
      letter-spacing: 1px;
      text-shadow: 0 10px 26px rgba(0,0,0,0.35);
      transform: translateY(2px);
    }

    /* Music button */
    .music-btn{
      position: fixed;
      left: 18px;
      bottom: 18px;
      width: 56px;
      height: 56px;
      border: none;
      border-radius: 999px;
      background: rgba(255,255,255,0.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.25);
      cursor: pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index: 50;
    }
    .music-btn:hover{ transform: translateY(-1px); }
    .music-btn:active{ transform: translateY(0px) scale(0.98); }

    .music-icon{
      font-size: 22px;
      line-height: 1;
      color: #ffffff;
      text-shadow: 0 2px 10px rgba(0,0,0,0.35);
    }
    .music-icon.pause{ display:none; }
    .music-btn.playing .music-icon.play{ display:none; }
    .music-btn.playing .music-icon.pause{ display:inline; }

    /* Fade transitions */
    .fade-out{ opacity:0; transform: translateY(6px); transition: opacity .35s ease, transform .35s ease; }
    .fade-in{ opacity:1; transform: translateY(0px); transition: opacity .45s ease, transform .45s ease; }
    #question{ opacity:1; transform: translateY(0px); transition: opacity .35s ease, transform .35s ease; }
    #response{ display:none; opacity:0; transform: translateY(6px); }

    /* GIF smooth fade-in */
    #gifWrap{
      margin-top: 18px;
      display:none;
      opacity:0;
      transform: translateY(6px);
      transition: opacity .5s ease, transform .5s ease;
    }
    #gifWrap.show{
      display:block;
      opacity:1;
      transform: translateY(0px);
    }
    #gifWrap img{
      width:min(360px, 86vw);
      border-radius: 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.16);
    }
  </style>
</head>

<body>
  <div class="bg"></div>
  <div id="bgHearts"></div>

  <!-- audio (must be triggered by user interaction to play on mobile) -->
  <audio id="music" preload="auto">
    <source src="./song.mp3" type="audio/mpeg" />
  </audio>

  <!-- music control -->
  <button id="playMusicBtn" class="music-btn" type="button" aria-label="Play or pause music" title="Play / Pause song">
    <span class="music-icon play">‚ñ∂</span>
    <span class="music-icon pause">‚è∏</span>
  </button>

  <div class="wrap">
    <div class="card">
      <div id="question">
        <h1>Hey Tonka ‚ù§Ô∏è</h1>
        <p>Will you be my Valentine?</p>

        <!-- Solid heart YES (also starts music) -->
        <button id="yesBtn" class="heartBtn" type="button" aria-label="Yes">
          <div class="heartShape"></div>
          <div class="heartText">YES</div>
        </button>

        <div class="btnRow">
          <button id="noBtn" class="btn btnNo" type="button">No</button>
        </div>
      </div>

      <div id="response">
        <h1>Yaaaay! üíñ</h1>
        <p>Now you‚Äôre stuck with me üòÑ</p>

        <div id="gifWrap">
          <img src="./giphy.gif" alt="Celebration gif" />
        </div>
      </div>
    </div>
  </div>

  <script>
  (() => {
    const music = document.getElementById('music');
    const playBtn = document.getElementById('playMusicBtn');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const question = document.getElementById('question');
    const response = document.getElementById('response');
    const gifWrap = document.getElementById('gifWrap');
    const bgHearts = document.getElementById('bgHearts');

    // Safety: if any element is missing, don‚Äôt crash (important for GitHub Pages debugging)
    if (!music || !playBtn || !yesBtn || !noBtn || !question || !response || !gifWrap || !bgHearts) return;

    const setPlayingUI = (isPlaying) => {
      playBtn.classList.toggle('playing', isPlaying);
    };

    music.addEventListener('play', () => setPlayingUI(true));
    music.addEventListener('pause', () => setPlayingUI(false));

    const ensurePlaying = async () => {
      // If already playing, do nothing (prevents YES from restarting / pausing)
      if (!music.paused) return;
      try {
        await music.play();
      } catch (e) {
        // Autoplay restrictions: user can press again
        setPlayingUI(false);
      }
    };

    playBtn.addEventListener('click', async () => {
      if (music.paused) await ensurePlaying();
      else music.pause();
    });

    yesBtn.addEventListener('click', async () => {
      await ensurePlaying();

      question.classList.add('fade-out');
      setTimeout(() => {
        question.style.display = 'none';
        response.style.display = 'block';
        response.classList.add('fade-in');
        gifWrap.classList.add('show');
        spawnHearts(18);
      }, 350);
    });

    // "No" runs away
    const moveNoButton = () => {
      const padding = 16;
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
      const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
      const rect = noBtn.getBoundingClientRect();

      const maxX = Math.max(padding, vw - rect.width - padding);
      const maxY = Math.max(padding, vh - rect.height - padding);

      const x = Math.floor(Math.random() * (maxX - padding + 1)) + padding;
      const y = Math.floor(Math.random() * (maxY - padding + 1)) + padding;

      noBtn.style.position = 'fixed';
      noBtn.style.left = x + 'px';
      noBtn.style.top = y + 'px';
    };

    noBtn.addEventListener('mouseenter', moveNoButton);
    noBtn.addEventListener('click', moveNoButton);

    // Hearts animation
    function spawnHearts(count) {
      for (let i = 0; i < count; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.textContent = '‚ù§';

        const x = Math.random() * 100;
        const size = 12 + Math.random() * 26;
        const duration = 3.5 + Math.random() * 3.5;
        const delay = Math.random() * 0.8;

        heart.style.left = x + 'vw';
        heart.style.fontSize = size + 'px';
        heart.style.animationDuration = duration + 's';
        heart.style.animationDelay = delay + 's';
        heart.style.opacity = (0.35 + Math.random() * 0.5).toFixed(2);

        bgHearts.appendChild(heart);
        heart.addEventListener('animationend', () => heart.remove());
      }
    }

    spawnHearts(10);
    setInterval(() => spawnHearts(6), 1600);

    // initial UI state
    setPlayingUI(!music.paused);
  })();
  </script>
</body>
</html>
